{# ========================================== #}
{# REUSABLE AUTH MACROS FOR SIGNUP/LOGIN #}
{# ========================================== #}

{# --- 1. INPUT FIELD MACRO --- #}
{# type: email, password, text, etc. #}
{# icon_class: remixicon class (e.g. ri-mail-line) #}
{# error: optional error message #}
{% macro input_field(id, type, placeholder, icon_class, error=None, autocomplete_type='off') %}
<div class="relative group">
    <div class="absolute left-4 top-1/2 -translate-y-1/2 text-white/40 group-focus-within:text-white transition-colors duration-300 pointer-events-none">
        <i class="{{ icon_class }} text-xl"></i>
    </div>
    <input 
        type="{{ type }}" 
        id="{{ id }}" 
        name="{{ id }}"
        class="w-full bg-white/5 border border-white/10 rounded-xl px-12 py-4 text-white placeholder-white/30 focus:outline-none focus:border-blue-500/50 focus:bg-white/10 transition-all duration-300 font-medium disabled:opacity-50 disabled:cursor-not-allowed {% if error %}border-red-500/50{% endif %}"
        placeholder="{{ placeholder }}" 
        required
        autocomplete="{{ autocomplete_type }}"
        aria-label="{{ placeholder }}"
    >
    {% if error %}
    <span class="absolute top-full left-4 mt-1 text-xs text-red-400 font-medium">{{ error }}</span>
    {% endif %}
</div>
{% endmacro %}

{# --- 2. SUBMIT BUTTON MACRO --- #}
{# Shows loading spinner on submit #}
{% macro submit_button(text, button_id='authBtn') %}
<button 
    type="submit" 
    id="{{ button_id }}" 
    class="w-full bg-white text-black font-bold rounded-xl py-4 mt-6 hover:scale-[1.02] active:scale-[0.98] transition-all duration-300 relative overflow-hidden group disabled:opacity-70 disabled:scale-100 disabled:cursor-not-allowed"
    aria-label="{{ text }}"
>
    <span id="btnText" class="relative z-10 inline-block">{{ text }}</span>
    <div id="btnLoader" class="hidden absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2">
        <div class="w-5 h-5 border-2 border-black/30 border-t-black rounded-full animate-spin"></div>
    </div>
    <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-[100%] group-hover:animate-shimmer"></div>
</button>

<style>
    @keyframes shimmer {
        100% { transform: translateX(100%); }
    }
    .group-hover\:animate-shimmer {
        animation: shimmer 1.5s infinite;
    }
</style>
{% endmacro %}

{# --- 3. OAUTH BUTTONS MACRO --- #}
{# Initiates server-side OAuth flow via backend endpoint #}
{% macro oauth_buttons() %}
<div class="grid grid-cols-2 gap-3 mb-6">
    <button 
        type="button" 
        onclick="oauthLogin('google')" 
        class="flex items-center justify-center gap-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl py-3 transition-all duration-300 hover:border-white/20 group disabled:opacity-50 disabled:cursor-not-allowed"
        aria-label="Sign in with Google"
    >
        <i class="ri-google-fill text-xl text-white group-hover:scale-110 transition-transform"></i>
        <span class="text-sm font-semibold text-white/90">Google</span>
    </button>
    <button 
        type="button" 
        onclick="oauthLogin('github')" 
        class="flex items-center justify-center gap-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl py-3 transition-all duration-300 hover:border-white/20 group disabled:opacity-50 disabled:cursor-not-allowed"
        aria-label="Sign in with GitHub"
    >
        <i class="ri-github-fill text-xl text-white group-hover:scale-110 transition-transform"></i>
        <span class="text-sm font-semibold text-white/90">GitHub</span>
    </button>
</div>

<div class="relative flex items-center justify-center mb-6">
    <div class="absolute inset-0 flex items-center">
        <div class="w-full border-t border-white/10"></div>
    </div>
    <span class="relative bg-[#0A0A0A] px-4 text-xs font-semibold text-white/40 tracking-wider uppercase">Or continue with email</span>
</div>
{% endmacro %}

{# --- 4. ERROR MESSAGE DISPLAY --- #}
{% macro error_alert(message, alert_id='errorAlert') %}
<div id="{{ alert_id }}" class="hidden mb-4 p-4 rounded-lg bg-red-500/10 border border-red-500/30 text-red-400 text-sm animate-in fade-in">
    <div class="flex items-center gap-2">
        <i class="ri-alert-circle-line text-lg"></i>
        <span id="errorMessage">{{ message }}</span>
    </div>
</div>
{% endmacro %}

{# --- 5. SUCCESS MESSAGE DISPLAY --- #}
{% macro success_alert(message, alert_id='successAlert') %}
<div id="{{ alert_id }}" class="hidden mb-4 p-4 rounded-lg bg-green-500/10 border border-green-500/30 text-green-400 text-sm animate-in fade-in">
    <div class="flex items-center gap-2">
        <i class="ri-check-circle-line text-lg"></i>
        <span id="successMessage">{{ message }}</span>
    </div>
</div>
{% endmacro %}

{# --- 6. FORM WRAPPER --- #}
{% macro form_wrapper(title, subtitle='') %}
<div class="w-full max-w-[420px] px-4 mx-auto">
    <div id="authCard" class="card bg-[#0A0A0A]/90 border border-white/10 shadow-2xl rounded-2xl p-8 text-center backdrop-blur-xl">
        <h2 class="text-2xl font-bold text-white mb-2" id="formTitle">{{ title }}</h2>
        {% if subtitle %}<p class="text-xs text-neutral-500 mb-6">{{ subtitle }}</p>{% endif %}
        {{ caller() }}
    </div>
</div>
{% endmacro %}
