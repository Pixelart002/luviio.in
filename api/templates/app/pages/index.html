{% extends "app/base.html" %}

{% from "macros/index_page/header.html" import render_header %}
{% from "macros/index_page/drawer.html" import render_drawer %}
{% from "macros/index_page/footer.html" import render_footer %}
{% from "macros/index_page/hero.html" import render_hero %}

{% block header %}
{{ render_header() }}
{% endblock %}

{% block content %}
<!-- Drawer -->
{{ render_drawer() }}

<!-- Main content -->
<div id="main-content" class="w-full">
  {{ render_hero() }}

  <!-- SECTION 1: GSAP STAGGER SHOWCASE (3D CARD FLIP - BEKAR BENTO HATAYA) -->
  <section class="relative w-full min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 py-24 perspective overflow-hidden">
    <div class="max-w-7xl mx-auto px-6 text-center mb-20">
      <h2 class="font-['Playfair_Display'] text-6xl md:text-7xl text-white mb-4">
        GSAP <span class="text-teal-400">STAGGER</span>
      </h2>
      <p class="text-slate-300 text-xl">Advanced 3D flip with custom stagger patterns</p>
    </div>

    <!-- Stagger Grid - 3x3 Cards -->
    <div class="grid grid-cols-2 md:grid-cols-3 gap-6 max-w-6xl mx-auto px-6" id="stagger-grid">
      <!-- Cards will be populated by JS -->
    </div>
  </section>

  <!-- SECTION 2: RIVE INTERACTIVE ICONS (AAPKE JHOLE KA UPYOG) -->
  <section class="relative w-full py-32 bg-slate-800">
    <div class="max-w-7xl mx-auto px-6 text-center mb-16">
      <h2 class="font-['Playfair_Display'] text-5xl md:text-6xl text-white mb-4">
        Rive <span class="text-teal-400">Interactive</span>
      </h2>
      <p class="text-slate-300 text-lg">Icons that react to your mouse</p>
    </div>

    <div class="flex flex-wrap justify-center gap-12 items-center">
      <!-- Rive Icon 1 -->
      <div class="text-center">
        <div class="w-32 h-32 md:w-40 md:h-40 bg-white/10 rounded-3xl p-4 backdrop-blur-sm">
          <canvas id="rive-icon-1" width="160" height="160"></canvas>
        </div>
        <p class="text-white mt-4 font-medium">Bath</p>
      </div>

      <!-- Rive Icon 2 -->
      <div class="text-center">
        <div class="w-32 h-32 md:w-40 md:h-40 bg-white/10 rounded-3xl p-4 backdrop-blur-sm">
          <canvas id="rive-icon-2" width="160" height="160"></canvas>
        </div>
        <p class="text-white mt-4 font-medium">Water</p>
      </div>

      <!-- Rive Icon 3 -->
      <div class="text-center">
        <div class="w-32 h-32 md:w-40 md:h-40 bg-white/10 rounded-3xl p-4 backdrop-blur-sm">
          <canvas id="rive-icon-3" width="160" height="160"></canvas>
        </div>
        <p class="text-white mt-4 font-medium">Ceramic</p>
      </div>
    </div>
  </section>

  <!-- SECTION 3: SWIPER 11 HORIZONTAL GALLERY (BEKAR TRACK HATAYA) -->
  <section class="relative w-full py-32 bg-slate-900">
    <div class="max-w-7xl mx-auto px-6 text-center mb-16">
      <h2 class="font-['Playfair_Display'] text-5xl md:text-6xl text-white mb-4">
        Swiper <span class="text-teal-400">11</span>
      </h2>
      <p class="text-slate-300 text-lg">Touch-enabled horizontal gallery</p>
    </div>

    <div class="swiper mySwiper w-full h-[500px]">
      <div class="swiper-wrapper">
        <!-- Slides will be added by JS -->
      </div>
      <div class="swiper-pagination"></div>
      <div class="swiper-button-next text-teal-400"></div>
      <div class="swiper-button-prev text-teal-400"></div>
    </div>
  </section>

  <!-- SECTION 4: ACETERNITY SPOTLIGHT CARD (SIRF YAHI USE KIYA) -->
  <section class="py-24 bg-slate-800 flex justify-center">
    <div class="group relative max-w-lg w-full">
      <div class="absolute -inset-1 bg-gradient-to-r from-teal-600 to-purple-600 rounded-2xl blur opacity-40 group-hover:opacity-80 transition duration-1000"></div>
      <div class="relative px-10 py-12 bg-white rounded-2xl text-center">
        <h3 class="text-3xl font-bold text-slate-900 mb-3">The Experience Center</h3>
        <p class="text-slate-600 mb-6">Book a private tour of our flagship studio.</p>
        <button class="px-8 py-3 bg-teal-600 text-white rounded-full font-medium hover:bg-teal-700 transition-all transform hover:scale-105">
          Reserve Now
        </button>
      </div>
    </div>
  </section>
</div>

{{ render_footer() }}
{% endblock %}

{% block scripts %}
<!-- Vanilla JS for drawer toggling (same) -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const hamburgerBtn = document.getElementById('hamburgerBtn');
    const drawer = document.getElementById('drawer');
    const overlay = document.getElementById('drawerOverlay');
    const closeBtn = document.getElementById('closeDrawerBtn');
    const drawerLinks = drawer ? drawer.querySelectorAll('a') : [];
    
    function openDrawer() {
      if (drawer) {
        drawer.classList.remove('-translate-x-full');
        overlay.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
        
        const spans = hamburgerBtn?.querySelectorAll('span');
        if (spans && spans.length === 3) {
          spans[0].style.transform = 'rotate(45deg) translateY(9px)';
          spans[1].style.opacity = '0';
          spans[2].style.transform = 'rotate(-45deg) translateY(-9px)';
        }
      }
    }
    
    function closeDrawer() {
      if (drawer) {
        drawer.classList.add('-translate-x-full');
        overlay.classList.add('hidden');
        document.body.style.overflow = '';
        
        const spans = hamburgerBtn?.querySelectorAll('span');
        if (spans && spans.length === 3) {
          spans[0].style.transform = 'rotate(0) translateY(0)';
          spans[1].style.opacity = '1';
          spans[2].style.transform = 'rotate(0) translateY(0)';
        }
      }
    }
    
    if (hamburgerBtn) hamburgerBtn.addEventListener('click', openDrawer);
    if (closeBtn) closeBtn.addEventListener('click', closeDrawer);
    if (overlay) overlay.addEventListener('click', closeDrawer);
    
    drawerLinks.forEach(link => link.addEventListener('click', closeDrawer));
    
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && drawer && !drawer.classList.contains('-translate-x-full')) {
        closeDrawer();
      }
    });
  });
</script>

<!-- Active Navigation Script (same) -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const navLinks = document.querySelectorAll('.nav-link');
    
    function setActiveLink(clickedLink) {
      navLinks.forEach(link => {
        link.classList.remove('text-teal-800', 'bg-white', 'shadow-sm');
        if (link.closest('nav')) {
          link.classList.add('text-slate-600', 'hover:text-teal-700', 'hover:bg-white');
        } else {
          link.classList.remove('text-teal-700');
        }
      });
      
      if (clickedLink.closest('nav')) {
        clickedLink.classList.remove('text-slate-600', 'hover:text-teal-700', 'hover:bg-white');
        clickedLink.classList.add('text-teal-800', 'bg-white', 'shadow-sm');
      } else {
        clickedLink.classList.add('text-teal-700');
      }
    }
    
    navLinks.forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        setActiveLink(this);
        
        const drawer = document.getElementById('drawer');
        if (drawer && !drawer.classList.contains('-translate-x-full')) {
          document.getElementById('closeDrawerBtn')?.click();
        }
        
        const href = this.getAttribute('href');
        if (href && href !== '#') {
          const targetId = href.replace('/', '');
          const targetSection = document.getElementById(targetId);
          if (targetSection) {
            targetSection.scrollIntoView({ behavior: 'smooth' });
          }
        }
      });
    });
    
    const path = window.location.pathname;
    let activeFound = false;
    navLinks.forEach(link => {
      if (link.getAttribute('href') === path) {
        setActiveLink(link);
        activeFound = true;
      }
    });
    if (!activeFound && navLinks.length > 0) {
      setActiveLink(navLinks[0]);
    }
  });
</script>

<!-- MAIN ANIMATIONS - GSAP STAGGER + RIVE + SWIPER -->
<script>
  (function() {
    if (typeof gsap === 'undefined') return;
    gsap.registerPlugin(ScrollTrigger);

    // --- 1. GSAP STAGGER GRID (BEKAR BENTO KI JAGAH YEH LO) ---
    const staggerGrid = document.getElementById('stagger-grid');
    if (staggerGrid) {
      // Empty grid
      staggerGrid.innerHTML = '';

      // 9 cards with different images
      const images = [
        'https://images.unsplash.com/photo-1618220179428-22790b461013?w=600&q=90',
        'https://images.unsplash.com/photo-1618219944342-824e40a1328e?w=600&q=90',
        'https://images.unsplash.com/photo-1584622650111-993a426fbf0a?w=600&q=90',
        'https://images.unsplash.com/photo-1600566753086-00f18fb6b3ea?w=600&q=90',
        'https://images.unsplash.com/photo-1616486338812-3dadae4b4ace?w=600&q=90',
        'https://images.unsplash.com/photo-1616046229478-9901c5536a45?w=600&q=90',
        'https://images.unsplash.com/photo-1604014237800-1c9102c219da?w=600&q=90',
        'https://images.unsplash.com/photo-1600566753190-17f0baa2a6c3?w=600&q=90',
        'https://images.unsplash.com/photo-1618220179428-22790b461013?w=600&q=90'
      ];

      images.forEach((src, i) => {
        const card = document.createElement('div');
        card.className = 'stagger-card aspect-square rounded-2xl overflow-hidden shadow-2xl relative group';
        card.style.background = `url(${src}) center/cover`;
        card.style.transformStyle = 'preserve-3d';
        card.style.border = '2px solid rgba(255,255,255,0.1)';
        
        // Overlay with number
        const overlay = document.createElement('div');
        overlay.className = 'absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4';
        overlay.innerHTML = `<span class="text-white text-xl font-bold">${String(i + 1).padStart(2, '0')}</span>`;
        card.appendChild(overlay);
        
        staggerGrid.appendChild(card);
      });

      // --- POWERFUL STAGGER ANIMATION (scroll-triggered) ---
      gsap.from('.stagger-card', {
        scrollTrigger: {
          trigger: '#stagger-grid',
          start: 'top 70%',
          end: 'bottom 30%',
          scrub: 1.2,
          toggleActions: 'play none none reverse'
        },
        rotationY: (i) => (i % 3 === 0 ? 180 : i % 3 === 1 ? 90 : -90),
        rotationX: (i) => (i % 2 === 0 ? 30 : -30),
        opacity: 0,
        scale: 0.5,
        stagger: {
          amount: 1.5,      // Total time for all cards
          from: "center",   // Start from center
          grid: [3, 3],     // 3x3 grid
          ease: "power2.inOut"
        },
        ease: "power2.out"
      });

      ScrollTrigger.refresh();
    }

    // --- 2. RIVE INTERACTIVE ICONS (AAPKE JHOLE KA ASLI UPYOG) ---
    if (typeof rive !== 'undefined') {
      // Icon 1 - Bath (interactive)
      const rive1 = new rive.Rive({
        src: 'https://cdn.rive.app/animations/vehicles.riv', // Replace with your bath icon
        canvas: document.getElementById('rive-icon-1'),
        autoplay: true,
        stateMachines: 'bumpy',
        onLoad: () => rive1.resizeDrawingSurfaceToCanvas()
      });

      // Icon 2 - Water
      const rive2 = new rive.Rive({
        src: 'https://cdn.rive.app/animations/vehicles.riv', // Replace with water icon
        canvas: document.getElementById('rive-icon-2'),
        autoplay: true,
        stateMachines: 'bumpy',
        onLoad: () => rive2.resizeDrawingSurfaceToCanvas()
      });

      // Icon 3 - Ceramic
      const rive3 = new rive.Rive({
        src: 'https://cdn.rive.app/animations/vehicles.riv', // Replace with ceramic icon
        canvas: document.getElementById('rive-icon-3'),
        autoplay: true,
        stateMachines: 'bumpy',
        onLoad: () => rive3.resizeDrawingSurfaceToCanvas()
      });

      // Mouse interaction example
      const canvases = document.querySelectorAll('canvas[id^="rive-icon"]');
      canvases.forEach(canvas => {
        canvas.addEventListener('mouseenter', () => {
          // You can trigger specific states if you have custom Rive files
        });
      });
    }

    // --- 3. SWIPER 11 (BEKAR HORIZONTAL TRACK HATAYA) ---
    if (typeof Swiper !== 'undefined') {
      const swiperWrapper = document.querySelector('.swiper-wrapper');
      if (swiperWrapper) {
        // Add slides
        const slideImages = [
          'https://images.unsplash.com/photo-1618220179428-22790b461013?w=1200&q=90',
          'https://images.unsplash.com/photo-1618219944342-824e40a1328e?w=1200&q=90',
          'https://images.unsplash.com/photo-1584622650111-993a426fbf0a?w=1200&q=90',
          'https://images.unsplash.com/photo-1600566753086-00f18fb6b3ea?w=1200&q=90',
          'https://images.unsplash.com/photo-1616486338812-3dadae4b4ace?w=1200&q=90'
        ];

        slideImages.forEach(src => {
          const slide = document.createElement('div');
          slide.className = 'swiper-slide';
          slide.innerHTML = `<div class="w-full h-full rounded-3xl overflow-hidden shadow-2xl"><img src="${src}" class="w-full h-full object-cover"></div>`;
          swiperWrapper.appendChild(slide);
        });

        // Initialize Swiper
        new Swiper('.mySwiper', {
          slidesPerView: 1,
          spaceBetween: 30,
          centeredSlides: true,
          loop: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
          breakpoints: {
            768: {
              slidesPerView: 2,
            },
            1024: {
              slidesPerView: 3,
            }
          }
        });
      }
    }

    // --- 4. INFINITE MARQUEE (AGAR HAI TO) ---
    const marqueeTrack = document.querySelector('.marquee-track');
    if (marqueeTrack) {
      const marqueeContent = marqueeTrack.innerHTML;
      marqueeTrack.innerHTML += marqueeContent;
      const trackWidth = marqueeTrack.scrollWidth / 2;
      gsap.to(marqueeTrack, {
        x: -trackWidth,
        duration: 20,
        ease: "none",
        repeat: -1,
        modifiers: { x: (x) => parseFloat(x) % trackWidth + 'px' }
      });
    }

  })();
</script>
{% endblock %}