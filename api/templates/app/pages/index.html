{# 
    STRICTLY TYPED INDEX PAGE 
    Extends: Base Layout
    Logic: Composition Root (Calls Macros)
#}
{% extends "app/base.html" %}

{# --- 1. IMPORTING BEAST MACROS (From your repo structure) --- #}
{% from "macros/layout/header.html"  import render_header %}
{% from "macros/layout/nav.html"     import render_nav %}
{% from "macros/layout/main.html"    import render_main_wrapper %}
{% from "macros/layout/section.html" import render_section %}
{% from "macros/layout/article.html" import render_article %}
{% from "macros/layout/aside.html"   import render_aside %}
{% from "macros/layout/footer.html"  import render_footer %}

{# --- 2. PAGE CONFIGURATION --- #}
{% block title %}Dashboard | Luviio Beast{% endblock %}

{# --- 3. PAGE COMPOSITION (The Semantic Flow) --- #}
{% block body_content %}

{# A. HEADER #}
{# Passing 'state' object from FastAPI Backend #}
{{ render_header(user=state.user_info) }}

{# B. NAVIGATION #}
{{ render_nav(active_page='home', items=state.nav_items) }}

{# C. MAIN CONTENT AREA (Wrapper Macro) #}
{# 'render_main_wrapper' creates the <main> tag and grid layout #}
{% call render_main_wrapper() %}

{# C-1. PRIMARY CONTENT (Sections & Articles) #}
{# This div usually takes col-span-8 in Tailwind #}
<div class="layout-primary-col flex flex-col gap-8">
  
  {# Section: Latest Updates #}
  {% call render_section(title="System Feeds", id="feeds") %}
  
  {# Loop through dynamic articles from State #}
  {% if state.articles %}
  {% for article in state.articles %}
  {{ render_article(
                            title=article.title,
                            content=article.content,
                            badge=article.badge,
                            date=article.date
                        ) }}
  {% endfor %}
  {% else %}
  <p class="text-gray-500 italic p-4">No active feeds available.</p>
  {% endif %}
  
  {% endcall %}
  
</div>

{# C-2. SECONDARY SIDEBAR (Aside) #}
{# This div usually takes col-span-4 in Tailwind #}
<div class="layout-secondary-col">
  {{ render_aside(
                title="Quick Diagnostics", 
                stats=state.system_stats,
                notifications=state.alerts
            ) }}
</div>

{% endcall %}

{# D. FOOTER #}
{{ render_footer(version="2.0.0 (Beast Mode)") }}

{% endblock %}

{# --- 4. PAGE SPECIFIC SCRIPTS --- #}
{# Hooks for Unpoly/GSAP specific to Index #}
{% block page_scripts %}
<script>
  // Beast Mode: Index Specific Animation Triggers
  document.addEventListener("DOMContentLoaded", () => {
    // Checking if GSAP Core is loaded via base.html
    if (typeof playPageLoadAnimation === 'function') {
      playPageLoadAnimation();
    }
  });
</script>
{% endblock %}