{% extends "app/base.html" %}

{# --- IMPORT MACROS --- #}
{% from "macros/layout/header.html"  import render_header %}
{% from "macros/layout/nav.html"     import render_nav %}
{% from "macros/layout/main.html"    import render_main_wrapper %}
{% from "macros/layout/section.html" import render_section %}
{% from "macros/layout/article.html" import render_article %}
{% from "macros/layout/aside.html"   import render_aside %}
{% from "macros/layout/footer.html"  import render_footer %}

{# --- PAGE CONFIG --- #}
{% block title %}Dashboard | Luviio Beast{% endblock %}

{# --- PAGE LOGIC --- #}
{% block body_content %}

{# 1. HEADER (Use Expression Syntax {{ }}, NOT Call Block) #}
{{ render_header(user=state.user_info) }}

{# 2. NAVIGATION (Z-Index handled inside macro) #}
{{ render_nav(active_page='home', items=state.nav_items) }}

{# 3. MAIN LAYOUT WRAPPER (This uses call block because it wraps content) #}
{% call render_main_wrapper() %}

{# LEFT COLUMN: Content Feeds #}
<div class="lg:col-span-8 flex flex-col gap-8">
  {% call render_section(title="System Feeds", id="feeds") %}
  {% if state.articles %}
  {% for article in state.articles %}
  {{ render_article(
                            title=article.title,
                            content=article.content,
                            badge=article.badge,
                            date=article.date
                        ) }}
  {% endfor %}
  {% else %}
  <div class="p-8 text-center text-slate-400 bg-white rounded-xl border border-dashed border-slate-200">
    No active feeds available via Beast API.
  </div>
  {% endif %}
  {% endcall %}
</div>

{# RIGHT COLUMN: Sidebar #}
<div class="lg:col-span-4">
  {{ render_aside(
                title="Live Diagnostics", 
                stats=state.system_stats,
                notifications=state.alerts
            ) }}
</div>

{% endcall %}

{# 4. FOOTER #}
{{ render_footer(version="2.1.0") }}

{% endblock %}